(this["webpackJsonp@coreui/coreui-pro-react-admin-template"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template"]||[]).push([[35],{1085:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return w}));var n=a(320);var r=a(42),c=a(805),s=a(107),l=a(289),i=a.n(l),o=a(290),u=a(30),d=a(31),m=a(33),f=a(32),h=a(0),p=a.n(h),v=a(504),g=a(505),b=a(419),y=a(300),S=a(323),E=a(385),O=a(303),C=a(358),j=a(426),D=a(802),w=(a(788),function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var l;Object(u.a)(this,a),(l=t.call(this,e)).fetchRecruiters=Object(o.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.a)();case 2:void 0!==(t=e.sent).staff?(a=t.staff.filter((function(e){return 2===e.role_id})),l.setState({recruiters:a})):void 0!==t.recruiters&&(n=t.recruiters,l.setState({recruiters:n}),l.setState({selectedRecruiter:n[0]}),l.setState({recruitersIsClearable:!1}));case 4:case"end":return e.stop()}}),e)}))),l.fetchCompanies=Object(o.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.k)(0,1,1);case 2:t=e.sent,a=l.state.selectedRecruiter,n=t.companies.filter((function(e){return e.vacancies>0&&(null!==a&&e.recruiters.indexOf(a.id)+1>0||null===a)})),l.setState({companies:n});case 6:case"end":return e.stop()}}),e)}))),l.fetchVacancies=Object(o.a)(i.a.mark((function e(){var t,a,n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.state,a=t.selectedCompany,n=t.selectedRecruiter,e.next=3,Object(C.d)(null!==a?a.id:null,!0,!0);case 3:r=e.sent,c=r.vacancies.filter((function(e){return null!==n&&e.recruiters.indexOf(n.id)+1>0||null===n})),l.setState({vacancies:c});case 6:case"end":return e.stop()}}),e)}))),l.fetchTags=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(C.c)();case 2:t=e.sent,l.setState({tags:t});case 4:case"end":return e.stop()}}),e)}))),l.fetchCandidatesData=Object(o.a)(i.a.mark((function e(){var t,a,n,r,c,s,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.state,a=t.selectedRecruiter,n=t.selectedCompany,r=t.selectedVacancy,c=t.selectedTag,s=t.selectedStartDate,o=t.selectedEndDate,e.next=3,Object(j.e)(a?a.id:0,n?n.id:0,r?r.id:0,c?c.id:0,s,o);case 3:void 0!==(u=e.sent)?(u=u.data,l.setState({funnelData:u})):l.setState({funnelData:null});case 5:case"end":return e.stop()}}),e)}))),l.fetchStatuses=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.k)();case 2:t=e.sent,l.setState({statuses:t}),l.setState({selectedStatuses:t});case 5:case"end":return e.stop()}}),e)}))),l.handleRecruiterSelect=function(e){l.setState({selectedRecruiter:e})},l.handleCompanySelect=function(e){l.setState({selectedCompany:e})},l.handleVacancySelect=function(e){var t=l.state,a=t.selectedCompany,n=t.companies;null!==e&&(a=n.filter((function(t){return t.id===e.company_id}))[0]),l.setState({selectedVacancy:e,selectedCompany:a})},l.handleTagsSelect=function(e){l.setState({selectedTag:e})},l.handleStatusChange=function(e){l.setState({selectedStatuses:e})},l.handleDate=function(e){var t=e.target,a=t.name,n=t.value;l.setState(Object(s.a)({},a,n))},l.renderChart=function(){var e=l.state,t=e.funnelData,a=e.selectedStatuses;if(null!==t&&void 0!==t){var s,i=Object.entries(t).reduceRight((function(e,t,a,n){var s=Object(c.a)(t,2),l=s[0],i=s[1],o=n[a+1];if(o){var u=Object(c.a)(o,1)[0];e[l]=Object(r.a)(Object(r.a)({},i),{},{count:e[u].count+i.count})}else e[l]=i;return e}),{}),o=[],u=function(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(n.a)(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c,s=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,c=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw c}}}}(Object.entries(i).reverse());try{var d=function(){var e=Object(c.a)(s.value,2),t=e[0],n=e[1];a.filter((function(e){return e.label===t})).length>0&&o.push({stat:t,count:n.count,color:n.color,percentage:100})};for(u.s();!(s=u.n()).done;)d()}catch(E){u.e(E)}finally{u.f()}o=o.reduce((function(e,t,a,n){var r=n[a-1];return r&&(r.count>0?t.percentage=(100*parseFloat(t.count)/parseFloat(r.count)).toFixed(0):t.percentage=0),e[a]=t,e}),{});for(var m=[],f=0,h=Object.entries(o);f<h.length;f++){var v=Object(c.a)(h[f],2),g=(v[0],v[1]);m.push({stat:g.stat+" "+g.percentage+"%",count:g.count,color:g.color})}var b=l.state,y=b.dynamicSlope,S=b.dynamicHeight;return p.a.createElement(D.a,{style:{margin:"0 auto",width:300,height:350}},p.a.createElement(D.f,{text:"Recruitment funnel"}),p.a.createElement(D.c,{style:{height:350}},p.a.createElement(D.d,{type:"funnel",data:m,categoryField:"stat",field:"count",colorField:"color",dynamicHeight:S,dynamicSlope:y},p.a.createElement(D.e,{color:"black",background:"none",format:"N0"}))),p.a.createElement(D.g,{render:function(e){var t=e.point;return(void 0===t?{}:t).category}}),p.a.createElement(D.b,{visible:!1}))}};var d=new Date,m=d.getFullYear(),f=d.getMonth(),h=new Date(m,f,2).toJSON().slice(0,10),v=new Date(m,f+1,0).toJSON().slice(0,10);return l.state={recruiters:[],companies:[],vacancies:[],tags:[],statuses:[],selectedRecruiter:null,selectedCompany:null,selectedVacancy:null,selectedTag:null,selectedStatuses:null,selectedStartDate:h,selectedEndDate:v,recruitersIsClearable:!0,funnelData:null,dynamicSlope:!0,dynamicHeight:!1},l}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.fetchRecruiters(),this.fetchCompanies(),this.fetchVacancies(),this.fetchTags(),this.fetchStatuses()}},{key:"componentDidUpdate",value:function(e,t){this.state.selectedRecruiter===t.selectedRecruiter&&this.state.selectedCompany===t.selectedCompany&&this.state.selectedVacancy===t.selectedVacancy&&this.state.selectedTag===t.selectedTag&&this.state.selectedStatuses===t.selectedStatuses&&this.state.selectedStartDate===t.selectedStartDate&&this.state.selectedEndDate===t.selectedEndDate||this.fetchCandidatesData(),this.state.selectedRecruiter!==t.selectedRecruiter&&(this.fetchCompanies(),this.fetchVacancies()),this.state.selectedCompany!==t.selectedCompany&&this.fetchVacancies()}},{key:"render",value:function(){var e=this.state,t=e.recruiters,a=e.selectedRecruiter,n=e.recruitersIsClearable,r=this.state,c=r.companies,s=r.selectedCompany,l=this.state,i=l.vacancies,o=l.selectedVacancy,u=this.state,d=(u.tags,u.selectedTag,this.state),m=d.statuses,f=d.selectedStatuses,h=this.state,E=h.selectedStartDate,O=h.selectedEndDate;return p.a.createElement(p.a.Fragment,null,p.a.createElement(v.a,{style:{marginBottom:"1rem"}},p.a.createElement(g.a,null,p.a.createElement("h1",{style:{marginBottom:0,fontSize:24}},"Recruitment funnel"))),p.a.createElement(v.a,{style:{marginBottom:"1rem"}},p.a.createElement(g.a,{xs:"12",sm:"12",md:"12",lg:"4",xl:"4"},p.a.createElement(b.a,{className:"filter-select"},p.a.createElement("label",{className:"date-filter-label"},"Filters"),p.a.createElement(S.a,{style:{marginBottom:15},value:a,options:t,isClearable:n,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return e.name},placeholder:"Recruiters",onChange:this.handleRecruiterSelect})),p.a.createElement(b.a,{className:"filter-select"},p.a.createElement(S.a,{style:{marginBottom:"1rem"},value:s,options:c,isClearable:!0,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return e.name},placeholder:"Companies",onChange:this.handleCompanySelect})),p.a.createElement(b.a,{className:"filter-select"},p.a.createElement(S.a,{style:{marginBottom:"1rem"},value:o,options:i,isClearable:!0,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return e.label},placeholder:"Vacancies",onChange:this.handleVacancySelect})),p.a.createElement(b.a,{className:"filter-select"},p.a.createElement(S.a,{isMulti:!0,value:f,options:m,placeholder:"Statuses",onChange:this.handleStatusChange}))),p.a.createElement(g.a,{xs:"12",sm:"12",md:"12",lg:"4",xl:"4"},p.a.createElement(v.a,{style:{marginBottom:"1rem"}},this.renderChart())),p.a.createElement(g.a,{lg:2,md:2},p.a.createElement(b.a,null,p.a.createElement("label",{className:"date-filter-label"},"Date From"),p.a.createElement(y.a,{id:"date-from",type:"date",name:"selectedStartDate",value:E,onChange:this.handleDate}))),p.a.createElement(g.a,{lg:2,md:2},p.a.createElement(b.a,null,p.a.createElement("label",{className:"date-filter-label"},"Date To"),p.a.createElement(y.a,{id:"date-to",type:"date",name:"selectedEndDate",value:O,onChange:this.handleDate})))))}}]),a}(h.Component))}}]);
//# sourceMappingURL=35.78405506.chunk.js.map