(this["webpackJsonp@coreui/coreui-pro-react-admin-template"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template"]||[]).push([[57],{1088:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return w}));var n=a(308);var c=a(42),r=a(812),s=a(107),l=a(288),i=a.n(l),o=a(289),u=a(30),d=a(31),m=a(33),f=a(32),h=a(0),p=a.n(h),g=a(505),v=a(506),b=a(421),y=a(300),S=a(324),E=a(391),O=a(302),C=a(359),j=a(430),D=a(809),w=(a(795),function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var l;Object(u.a)(this,a),(l=t.call(this,e)).fetchRecruiters=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.a)();case 2:t=e.sent,a=t.staff.filter((function(e){return 2===e.role_id})),l.setState({recruiters:a});case 5:case"end":return e.stop()}}),e)}))),l.fetchCompanies=Object(o.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.k)(0,1,1);case 2:t=e.sent,a=l.state.selectedRecruiter,n=t.companies.filter((function(e){return e.vacancies>0&&(null!==a&&e.recruiters.indexOf(a.id)+1>0||null===a)})),l.setState({companies:n});case 6:case"end":return e.stop()}}),e)}))),l.fetchVacancies=Object(o.a)(i.a.mark((function e(){var t,a,n,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.state,a=t.selectedCompany,n=t.selectedRecruiter,e.next=3,Object(C.d)(null!==a?a.id:null,!0,!0);case 3:c=e.sent,r=c.vacancies.filter((function(e){return null!==n&&e.recruiters.indexOf(n.id)+1>0||null===n})),l.setState({vacancies:r});case 6:case"end":return e.stop()}}),e)}))),l.fetchTags=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(C.c)();case 2:t=e.sent,l.setState({tags:t});case 4:case"end":return e.stop()}}),e)}))),l.fetchCandidatesData=Object(o.a)(i.a.mark((function e(){var t,a,n,c,r,s,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.state,a=t.selectedRecruiter,n=t.selectedCompany,c=t.selectedVacancy,r=t.selectedTag,s=t.selectedStartDate,o=t.selectedEndDate,e.next=3,Object(j.e)(a?a.id:0,n?n.id:0,c?c.id:0,r?r.id:0,s,o);case 3:void 0!==(u=e.sent)?(u=u.data,l.setState({funnelData:u})):l.setState({funnelData:null});case 5:case"end":return e.stop()}}),e)}))),l.fetchStatuses=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.k)();case 2:t=e.sent,l.setState({statuses:t}),l.setState({selectedStatuses:t});case 5:case"end":return e.stop()}}),e)}))),l.handleRecruiterSelect=function(e){l.setState({selectedRecruiter:e})},l.handleCompanySelect=function(e){l.setState({selectedCompany:e})},l.handleVacancySelect=function(e){l.setState({selectedVacancy:e})},l.handleTagsSelect=function(e){l.setState({selectedTag:e})},l.handleStatusChange=function(e){l.setState({selectedStatuses:e})},l.handleDate=function(e){var t=e.target,a=t.name,n=t.value;l.setState(Object(s.a)({},a,n))},l.renderChart=function(){var e=l.state,t=e.funnelData,a=e.selectedStatuses;if(null!==t&&void 0!==t){var s,i=Object.entries(t).reduceRight((function(e,t,a,n){var s=Object(r.a)(t,2),l=s[0],i=s[1],o=n[a+1];if(o){var u=Object(r.a)(o,1)[0];e[l]=Object(c.a)(Object(c.a)({},i),{},{count:e[u].count+i.count})}else e[l]=i;return e}),{}),o=[],u=function(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(n.a)(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,r,s=!0,l=!1;return{s:function(){c=e[Symbol.iterator]()},n:function(){var e=c.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==c.return||c.return()}finally{if(l)throw r}}}}(Object.entries(i).reverse());try{var d=function(){var e=Object(r.a)(s.value,2),t=e[0],n=e[1];a.filter((function(e){return e.label===t})).length>0&&o.push({stat:t,count:n.count,color:n.color,percentage:100})};for(u.s();!(s=u.n()).done;)d()}catch(E){u.e(E)}finally{u.f()}o=o.reduce((function(e,t,a,n){var c=n[a-1];return c&&(t.percentage=(100*parseFloat(t.count)/parseFloat(c.count)).toFixed(0)),e[a]=t,e}),{});for(var m=[],f=0,h=Object.entries(o);f<h.length;f++){var g=Object(r.a)(h[f],2),v=(g[0],g[1]);m.push({stat:v.stat+" "+v.percentage+"%",count:v.count,color:v.color})}var b=l.state,y=b.dynamicSlope,S=b.dynamicHeight;return p.a.createElement(D.a,{style:{margin:"0 auto",width:300,height:350}},p.a.createElement(D.f,{text:"Recruitment funnel"}),p.a.createElement(D.c,{style:{height:350}},p.a.createElement(D.d,{type:"funnel",data:m,categoryField:"stat",field:"count",colorField:"color",dynamicHeight:S,dynamicSlope:y},p.a.createElement(D.e,{color:"black",background:"none",format:"N0"}))),p.a.createElement(D.g,{render:function(e){var t=e.point;return(void 0===t?{}:t).category}}),p.a.createElement(D.b,{visible:!1}))}};var d=new Date,m=d.getFullYear(),f=d.getMonth(),h=new Date(m,f,2).toJSON().slice(0,10),g=new Date(m,f+1,0).toJSON().slice(0,10);return l.state={recruiters:[],companies:[],vacancies:[],tags:[],statuses:[],selectedRecruiter:null,selectedCompany:null,selectedVacancy:null,selectedTag:null,selectedStatuses:null,selectedStartDate:h,selectedEndDate:g,funnelData:null,dynamicSlope:!0,dynamicHeight:!1},l}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.fetchRecruiters(),this.fetchCompanies(),this.fetchVacancies(),this.fetchTags(),this.fetchStatuses()}},{key:"componentDidUpdate",value:function(e,t){this.state.selectedRecruiter===t.selectedRecruiter&&this.state.selectedCompany===t.selectedCompany&&this.state.selectedVacancy===t.selectedVacancy&&this.state.selectedTag===t.selectedTag&&this.state.selectedStatuses===t.selectedStatuses&&this.state.selectedStartDate===t.selectedStartDate&&this.state.selectedEndDate===t.selectedEndDate||this.fetchCandidatesData(),this.state.selectedRecruiter!==t.selectedRecruiter&&(this.fetchCompanies(),this.fetchVacancies()),this.state.selectedCompany!==t.selectedCompany&&this.fetchVacancies()}},{key:"render",value:function(){var e=this.state,t=e.recruiters,a=e.selectedRecruiter,n=this.state,c=n.companies,r=n.selectedCompany,s=this.state,l=s.vacancies,i=s.selectedVacancy,o=this.state,u=(o.tags,o.selectedTag,this.state),d=u.statuses,m=u.selectedStatuses,f=this.state,h=f.selectedStartDate,E=f.selectedEndDate;return p.a.createElement(p.a.Fragment,null,p.a.createElement(g.a,{style:{marginBottom:"1rem"}},p.a.createElement(v.a,null,p.a.createElement("h1",{style:{marginBottom:0,fontSize:24}},"Recruitment funnel"))),p.a.createElement(g.a,{style:{marginBottom:"1rem"}},p.a.createElement(v.a,{xs:"12",sm:"12",md:"12",lg:"4",xl:"4"},p.a.createElement(b.a,{className:"filter-select"},p.a.createElement("label",{className:"date-filter-label"},"Filters"),p.a.createElement(S.a,{style:{marginBottom:15},value:a,options:t,isClearable:!0,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return e.name},placeholder:"Recruiters",onChange:this.handleRecruiterSelect})),p.a.createElement(b.a,{className:"filter-select"},p.a.createElement(S.a,{style:{marginBottom:"1rem"},value:r,options:c,isClearable:!0,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return e.name},placeholder:"Companies",onChange:this.handleCompanySelect})),p.a.createElement(b.a,{className:"filter-select"},p.a.createElement(S.a,{style:{marginBottom:"1rem"},value:i,options:l,isClearable:!0,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return e.label},placeholder:"Vacancies",onChange:this.handleVacancySelect})),p.a.createElement(b.a,{className:"filter-select"},p.a.createElement(S.a,{isMulti:!0,value:m,options:d,placeholder:"Statuses",onChange:this.handleStatusChange}))),p.a.createElement(v.a,{xs:"12",sm:"12",md:"12",lg:"4",xl:"4"},p.a.createElement(g.a,{style:{marginBottom:"1rem"}},this.renderChart())),p.a.createElement(v.a,{lg:2,md:2},p.a.createElement(b.a,null,p.a.createElement("label",{className:"date-filter-label"},"Date From"),p.a.createElement(y.a,{id:"date-from",type:"date",name:"selectedStartDate",value:h,onChange:this.handleDate}))),p.a.createElement(v.a,{lg:2,md:2},p.a.createElement(b.a,null,p.a.createElement("label",{className:"date-filter-label"},"Date To"),p.a.createElement(y.a,{id:"date-to",type:"date",name:"selectedEndDate",value:E,onChange:this.handleDate})))))}}]),a}(h.Component))}}]);
//# sourceMappingURL=57.b42e66bf.chunk.js.map